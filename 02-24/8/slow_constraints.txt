1 <= N, M <= 1,000
